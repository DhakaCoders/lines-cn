jQuery(function(d){d(function(){var r,o=d("form.checkout"),c={GET:"get-checkout-id",READY:"ready-to-process",AUTH:"auth-screen",PROCESSING:"processing"},t=c.GET,s=!1,u=!1;function e(e,o){switch(s=!1,e){case"sent":break;case"invalid":i('<div class="woocommerce-error">'+sumup_gateway_params.errors.invalid_form+"</div>"),t=c.GET;break;case"auth-screen":m(),r=d("#sumup-card"),d.scroll_to_notices(r);break;case"error":console.error("Error",o),i('<div class="woocommerce-error">'+sumup_gateway_params.errors.general_error+"</div>"),t=c.GET;break;case"success":"PAID"!==o.status?(t=c.GET,i('<div class="woocommerce-error">'+sumup_gateway_params.errors.general_error+"</div>")):(t=c.PROCESSING,sumup_gateway_params.transactionCode=o.transaction_code,a())}var r}function a(){if(!d("#payment_method_sumup").is(":checked"))return!0;if(s||u||t===c.AUTH)return!1;var e="";if(t===c.GET)e="&sumup_get_checkout_id=1";else{if(t===c.READY)return r.submit(),!(s=!0);t===c.PROCESSING&&(e="&sumup_process=1",e+="&sumup_checkout_id="+sumup_gateway_params.checkoutId,e+="&sumup_transaction_code="+sumup_gateway_params.transactionCode)}return d.ajax({type:"POST",url:wc_checkout_params.checkout_url,data:o.serialize()+e,dataType:"json",beforeSend:function(){u=!0,o.block({message:null})},success:function(o){u=!1;try{if("sumup_payment_info"===o.result)sumup_gateway_params.checkoutId=o.checkout_id,r.update({checkoutId:o.checkout_id}),t=c.PROCESSING,r.submit();else if("success"===o.result&&o.redirect)window.location.href=o.redirect;else{if("fail"!==o.result)throw"Invalid response";i('<div class="woocommerce-error">'+wc_checkout_params.i18n_checkout_error+"</div>")}}catch(e){void 0!==o.messages?i(o.messages):i('<div class="woocommerce-error">'+wc_checkout_params.i18n_checkout_error+"</div>")}},error:function(e,o,r){u=!1,i('<div class="woocommerce-error">'+r+"</div>")}}),!1}function i(e){d(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),o.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+e+"</div>"),m(),o.find(".input-text, select, input:checkbox").trigger("validate").blur(),function(){var e=d(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout");e.length||(e=o);d.scroll_to_notices(e)}(),d(document.body).trigger("checkout_error")}function m(){o.unblock()}function n(){t=c.GET}d("body").on("sumupCardInit",function(){r=SumUpCard.mount({checkoutId:"demo",onResponse:e,showSubmitButton:!1,showZipCode:"true"===sumup_gateway_params.showZipCode,locale:sumup_gateway_params.locale,showFooter:!1})}),d(function(){n()}),d("body").on("updated_checkout",n),d("body").on("payment_method_selected",n),d("form.woocommerce-checkout").on("checkout_place_order_sumup",a)})});